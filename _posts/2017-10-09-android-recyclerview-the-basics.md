---
layout: default
title: "Android RecyclerView - The Basics"
categories: [post]
tags: [android, recyclerview]
---

<div dir="ltr" style="text-align:left;">When it comes to displaying a lot of similar data on mobile, you usually rely on List or Grid structure. In Android you can implement this using ListView for Lists, GridView for Grids, or RecyclerView for both.<br /><div><br /></div><div><a href="https://developer.android.com/reference/android/support/v7/widget/RecyclerView.html" target="_blank">RecyclerView</a> provides advanced set of features to enable complex animations, child view decorations and performance compared to ListView or GridView.</div><div><br /></div><h2 style="text-align:left;">How it works</h2><h3 style="text-align:left;">Adapter and ViewHolder</h3><div>RecyclerView uses the <b><a href="https://developer.android.com/reference/android/support/v7/widget/RecyclerView.Adapter.html" target="_blank">Adapter</a></b> class to bind the data that you want to display to the corresponding Views. Unlike ListView, <b><a href="https://developer.android.com/reference/android/support/v7/widget/RecyclerView.ViewHolder.html" target="_blank">ViewHolder</a></b> is mandatory in RecyclerView. ViewHolder stores some meta information about the position of the view in the RecyclerView. ViewHolder should be used to cache findViewById of child views.<br /><br /><h3 style="text-align:left;">LayoutManager</h3>The way in which the data should be rendered i.e., either List or Grid is specified using a <b><a href="https://developer.android.com/reference/android/support/v7/widget/RecyclerView.LayoutManager.html" target="_blank">LayoutManager</a></b>. LayoutManager does the actual layout of the child views. RecyclerView provides three basic LayoutManagers:<br /><br /><ul style="text-align:left;"><li><b><a href="https://developer.android.com/reference/android/support/v7/widget/LinearLayoutManager.html" target="_blank">LinearLayoutManager</a></b> - for laying out children as a list either vertically or horizontally</li><li><b><a href="https://developer.android.com/reference/android/support/v7/widget/GridLayoutManager.html" target="_blank">GridLayoutManager</a></b> - for laying out children as a grid either vertically or horizontally</li><li><b><a href="https://developer.android.com/reference/android/support/v7/widget/StaggeredGridLayoutManager.html" target="_blank">StaggeredGridLayoutManager</a></b> - for laying out children in a staggered grid format, where each child may have different dimensions</li></ul><div>All three layout managers support reverse ordering of child views.</div><div><br /></div><h3 style="text-align:left;">Recycler</h3><div>There is a <b><a href="https://developer.android.com/reference/android/support/v7/widget/RecyclerView.Recycler.html" target="_blank">Recycler</a></b> class which is responsible to manage scrapped views and views that are recycled to be used in future. The LayoutManager won't directly communicate with the Adapter. Instead it contacts the Recycler for any recycled views and if available renders it. If not, Recycler asks the Adapter for a new view and gives it back to LayoutManager.</div><br /><h2 style="text-align:left;">RecyclerView Adapter</h2></div><div>The main functions that's required to override are</div><div><ul style="text-align:left;"><li>onCreateViewHolder</li><li>onBindViewHolder</li><li>getItemCount</li><li>getItemViewType</li></ul><div><h3 style="text-align:left;"><b>onCreateViewHolder</b></h3></div></div><div>This method is called each time a new view is required to be inflated for displaying child. This is where we create and return a new instance of the ViewHolder for each child item.</div><div>Whenever there is no child view to be reused a new view is created using this method.<br /><br /></div><div>It takes two parameters: a <code>parent</code> ViewGroup and a <code>viewType</code> int.<br />The <code>viewType</code> integer is used to identify the type of child view that needs to be displayed based on the data. Using this you can inflate the necessary view.</div><div><br /></div><div><i style="background-color:#fce5cd;"><b>Remember:</b> Do not try to cache the inflated views yourselves as it may lead to inconsistent behaviours. The necessary caching is done internally by RecyclerView itself.</i></div><div><i><br /></i></div><div>Here is a simple example of onCreateViewHolder:<br /><pre style="background:#000;color:#f8f8f8;">    @<span style="color:#99cf50;">Override</span><br />    <span style="color:#99cf50;">public</span> <span style="color:#99cf50;">UserViewHolder</span> onCreateViewHolder(<span style="color:#99cf50;">ViewGroup</span> parent, <span style="color:#99cf50;">int</span> viewType) {<br />        <span style="color:#99cf50;">View</span> view <span style="color:#e28964;">=</span> <span style="color:#99cf50;">LayoutInflater</span><span style="color:#e28964;">.</span>from(parent<span style="color:#e28964;">.</span>getContext())<br />                .inflate(<span style="color:#99cf50;">R</span><span style="color:#e28964;">.</span>layout<span style="color:#e28964;">.</span>layout_user_list_item, parent, <span style="color:#3387cc;">false</span>);<br />        <span style="color:#e28964;">return</span> <span style="color:#e28964;">new</span> <span style="color:#99cf50;">UserViewHolder</span>(view);<br />    }<br /><br /></pre><br />In this example, a layout is inflated using the LayoutInflater and a new ViewHolder is returned. This View is used as a child view and the ViewHolder is used to identify the views position within the RecyclerView and refer the views inside the child view.<br /><h3 style="text-align:left;">onBindViewHolder</h3><div>This is where the data at a given position is displayed on the child view. It takes two parameters: a <code>ViewHolder</code> and a <code>position</code>. By referring the view items in the ViewHolder you can show relevant information for the given <code>position</code> in RecyclerView. The ViewHolder is used to refer the view items and the position can be used to get the data from say, an ArrayList.</div><div><br /></div><div><span style="background-color:#fce5cd;"><b><i>Remember:</i></b> <i>For example, when using an <code>onClickListener</code> in this method you might make the position parameter final. Do not do this. Since RecyclerView will not call this method again if the position of the data in the ArrayList changes. So to handle this condition, you can use the <code>getAdapterPosition()</code> method of the ViewHolder inside onClickListener.</i></span><br /><i><br /></i>Here is an example of onBindViewHolder:<br /><br /></div><div><pre style="background:#000;color:#f8f8f8;">    @<span style="color:#99cf50;">Override</span><br />    <span style="color:#99cf50;">public</span> <span style="color:#99cf50;">void</span> onBindViewHolder(<span style="color:#99cf50;">UserViewHolder</span> holder, <span style="color:#99cf50;">int</span> position) {<br />        holder<span style="color:#e28964;">.</span>username<span style="color:#e28964;">.</span>setText(usersList<span style="color:#e28964;">.</span>get(position)<span style="color:#e28964;">.</span>getName());<br />        <span style="color:#99cf50;">Glide</span><span style="color:#e28964;">.</span>with(holder<span style="color:#e28964;">.</span>itemView)<span style="color:#e28964;">.</span>load(usersList<span style="color:#e28964;">.</span>get(position)<span style="color:#e28964;">.</span>getImageUrl())<span style="color:#e28964;">.</span>into(holder<span style="color:#e28964;">.</span>userAvatar);<br />    }<br /><br /></pre></div><br />In the code, <code>userList</code> is an ArrayList. Using the <code>position</code> param, the name of the user at that position in the ArrayList is retrieved. Now using the ViewHolder, the TextView is referred and the name is set to the it.<br /><br /><h3 style="text-align:left;">getItemCount</h3></div><div>This method is used to return the total number of data items that needs to be displayed in the Adapter. If it returns zero, no view items will be rendered. If any positive number is returned, then the adapter should handle that many data items.</div><div><br /></div><h3 style="text-align:left;">getItemViewType</h3><div>Sometimes you want to display different types of views based on different data at each position in RecyclerView. This is when getItemViewType is used.</div><div><br /></div><div>Based on the position parameter, you can return a integer representing the type of view that needs to be displayed at the position.<br /><pre style="background:#000;color:#f8f8f8;">    @<span style="color:#99cf50;">Override</span><br />    <span style="color:#99cf50;">public</span> <span style="color:#99cf50;">int</span> getItemViewType(<span style="color:#99cf50;">int</span> position) {<br />        <span style="color:#99cf50;">int</span> type;<br />        <span style="color:#e28964;">if</span> (<span style="color:#e28964;">!</span><span style="color:#99cf50;">TextUtils</span><span style="color:#e28964;">.</span>isEmpty(usersList<span style="color:#e28964;">.</span>get(position)<span style="color:#e28964;">.</span>getName())) {<br />            type <span style="color:#e28964;">=</span> <span style="color:#3387cc;">USER_TYPE</span>;<br />        } <span style="color:#e28964;">else</span> {<br />            type <span style="color:#e28964;">=</span> <span style="color:#3387cc;">HEADER_TYPE</span>;<br />        }<br />        <span style="color:#e28964;">return</span> type;<br />    }<br /><br /></pre><br />Here the type is represented by a constant integers. Now the type of view to be displayed is returned based on the data. Next change the onCreateViewHolder to return the relevant view based on the view type.<br /><pre style="background:#000;color:#f8f8f8;">    @<span style="color:#99cf50;">Override</span><br />    <span style="color:#99cf50;">public</span> <span style="color:#99cf50;">RecyclerView</span><span style="color:#e28964;">.</span><span style="color:#99cf50;">ViewHolder</span> onCreateViewHolder(<span style="color:#99cf50;">ViewGroup</span> parent, <span style="color:#99cf50;">int</span> viewType) {<br />        <span style="color:#99cf50;">View</span> view;<br />        <span style="color:#e28964;">switch</span> (viewType) {<br />            <span style="color:#e28964;">case</span> <span style="color:#3387cc;">USER_TYPE</span><span style="color:#e28964;">:</span><br />                view <span style="color:#e28964;">=</span> <span style="color:#99cf50;">LayoutInflater</span><span style="color:#e28964;">.</span>from(parent<span style="color:#e28964;">.</span>getContext())<br />                        .inflate(<span style="color:#99cf50;">R</span><span style="color:#e28964;">.</span>layout<span style="color:#e28964;">.</span>layout_user_list_item, parent, <span style="color:#3387cc;">false</span>);<br />                <span style="color:#e28964;">return</span> <span style="color:#e28964;">new</span> <span style="color:#99cf50;">UserViewHolder</span>(view);<br />            <span style="color:#e28964;">case</span> <span style="color:#3387cc;">HEADER_TYPE</span><span style="color:#e28964;">:</span><br />                view <span style="color:#e28964;">=</span> <span style="color:#99cf50;">LayoutInflater</span><span style="color:#e28964;">.</span>from(parent<span style="color:#e28964;">.</span>getContext())<br />                        .inflate(<span style="color:#99cf50;">R</span><span style="color:#e28964;">.</span>layout<span style="color:#e28964;">.</span>layout_user_list_section_header, parent, <span style="color:#3387cc;">false</span>);<br />                <span style="color:#e28964;">return</span> <span style="color:#e28964;">new</span> <span style="color:#99cf50;">SectionHeaderViewHolder</span>(view);<br />            <span style="color:#e28964;">default</span><span style="color:#e28964;">:</span><br />                view <span style="color:#e28964;">=</span> <span style="color:#99cf50;">LayoutInflater</span><span style="color:#e28964;">.</span>from(parent<span style="color:#e28964;">.</span>getContext())<br />                        .inflate(<span style="color:#99cf50;">R</span><span style="color:#e28964;">.</span>layout<span style="color:#e28964;">.</span>layout_user_list_item, parent, <span style="color:#3387cc;">false</span>);<br />                <span style="color:#e28964;">return</span> <span style="color:#e28964;">new</span> <span style="color:#99cf50;">UserViewHolder</span>(view);<br />        }<br />    }<br /><br /></pre><br />After that in onBindViewHolder bind the correct data to the correct view type using the relevant ViewHolder.<br /><pre style="background:#000;color:#f8f8f8;">    @<span style="color:#99cf50;">Override</span><br />    <span style="color:#99cf50;">public</span> <span style="color:#99cf50;">void</span> onBindViewHolder(<span style="color:#99cf50;">RecyclerView</span><span style="color:#e28964;">.</span><span style="color:#99cf50;">ViewHolder</span> holder, <span style="color:#99cf50;">int</span> position) {<br />        <span style="color:#99cf50;">int</span> itemViewType <span style="color:#e28964;">=</span> getItemViewType(position);<br />        <span style="color:#e28964;">if</span> (itemViewType <span style="color:#e28964;">==</span> <span style="color:#3387cc;">USER_TYPE</span>) {<br />            ((<span style="color:#99cf50;">UserViewHolder</span>) holder)<span style="color:#e28964;">.</span>username<span style="color:#e28964;">.</span>setText(usersList<span style="color:#e28964;">.</span>get(position)<span style="color:#e28964;">.</span>getName());<br />            <span style="color:#99cf50;">Glide</span><span style="color:#e28964;">.</span>with(holder<span style="color:#e28964;">.</span>itemView)<span style="color:#e28964;">.</span>load(usersList<span style="color:#e28964;">.</span>get(position)<span style="color:#e28964;">.</span>getImageUrl())<span style="color:#e28964;">.</span>into(((<span style="color:#99cf50;">UserViewHolder</span>) holder)<span style="color:#e28964;">.</span>userAvatar);<br />        } <span style="color:#e28964;">else</span> {<br />            ((<span style="color:#99cf50;">SectionHeaderViewHolder</span>) holder)<span style="color:#e28964;">.</span>sectionTitle<span style="color:#e28964;">.</span>setText(usersList<span style="color:#e28964;">.</span>get(position)<span style="color:#e28964;">.</span>getType());<br />        }<br />    }<br /><br /></pre><br />Here is how the UI looks like:<br /><br /><div class="separator" style="clear:both;text-align:center;"><a href="https://therubberduckdev.files.wordpress.com/2017/10/screenshot_20171009-003555.jpg" style="margin-left:1em;margin-right:1em;"><img alt="RecyclerView using view types" border="0" height="640" src="https://therubberduckdev.files.wordpress.com/2017/10/screenshot_20171009-003555.jpg?w=169" title="RecyclerView list using view types" width="360" /></a></div><br />Here the bold titles are the section headers which is represented by type <code>HEADER_TYPE</code> and user views are represented by type <code>USER_TYPE</code>.<br /><br />This is how you can create a simple RecyclerView.<br /><br />In the next post, I will cover how to decorate items like adding dividers and how to animate the views when new view is added, or a view is removed or changed.<br /><br />Source code <a href="https://github.com/sjthn/RecyclerViewDemo" target="_blank">here</a>.<br /><br />If you have any feedback, please comment below.<br /><br /></div></div>